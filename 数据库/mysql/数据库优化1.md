### 数据库结构优化

> 数据库结构是影响数据库性能的最大因素

#### 一、目的

1. 减少数据冗余，节约存储空间（空间）
2. 避免出现更新、插入异常
3. 提高查询效率（时间）

#### 二、范式

> 范式的作用一般体现在解决上面的1、2项

- 1NF：每个字段具有原子性，不能再分
- 2NF：非主键属性不能对主键**部分依赖**（解决方案：增加id作为主键）
- 3NF：非主键属性不能对主键**传递依赖**（解决方案：拆表）

#### 三、反范式化设计

> 使用空间来换时间

- 将一张简单的表合到一张较复杂的表上，避免关联查询
- 订单表上增加**用户手机号**和**订单价格**字段，这两个字段是常用的，并且订单价格可能发生变更，所以以下单时的价格为准

#### 四、物理设计

- 选择合适的存储引擎

- 为每个字段选择合适的类型：

  1. 数字 > 日期/二进制类型 > 字符串

  2. int(tinyint,smallint等等)选择，（float,double,decimal）选择，（char，varchar）选择

  3. 日期类型：datetime，timestamp（会随时区变化），date(只含日期)，time(只含时间)

     datetime(6)：意思是精确到小数点后6位微秒级

- innodb中使用主键为索引，所以主键最好小和有序